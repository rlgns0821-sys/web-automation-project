<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>SRT ìë™ì˜ˆë§¤ ì„¤ì •</title>
<link href="/assets/img/thunder_icon.png" rel="icon">
<style>
  :root {
    --primary: #6b1d1d;
    --primary-dark: #531515;
    --bg: #f8fafc;
    --card: #ffffff;
    --border: #e5e7eb;
    --text: #1f2937;
    --sub: #6b7280;
  }

  * { box-sizing: border-box; }

  body {
    margin: 0;
    font-family: system-ui, -apple-system, "Segoe UI", sans-serif;
    background: var(--bg);
    color: var(--text);
  }

  .page-wrap {
    max-width: 520px;
    margin: 60px auto;
    padding: 0 16px;
  }

  .card {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 28px;
    box-shadow: 0 10px 24px rgba(0,0,0,0.04);
  }

  .title {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 24px;
  }

  .title h2 {
    margin: 0;
    font-size: 22px;
  }

  .title span {
    font-size: 14px;
    color: var(--sub);
  }

  .form-row {
    display: flex;
    align-items: center;
    margin-bottom: 14px;
  }

  .form-row label {
    width: 110px; /* ë¼ë²¨ ë„ˆë¹„ ì‚´ì§ ëŠ˜ë¦¼ */
    font-size: 14px;
    font-weight: 600;
  }

  .form-row select,
  .form-row input {
    flex: 1;
    height: 40px;
    padding: 0 12px;
    border-radius: 10px;
    border: 1px solid var(--border);
    font-size: 14px;
    background: #fff;
  }
  
  /* ì½ê¸° ì „ìš© ì…ë ¥ì°½ ìŠ¤íƒ€ì¼ */
  input[readonly] {
    background-color: #f1f5f9;
    color: #64748b;
    cursor: not-allowed;
    border-color: #e2e8f0;
  }

  .form-row select:focus,
  .form-row input:focus {
    outline: none;
    border-color: var(--primary);
  }

  .btn-group {
    display: flex;
    gap: 10px;
    margin-top: 26px;
  }

  .btn {
    flex: 1;
    height: 44px;
    border-radius: 12px;
    font-size: 15px;
    font-weight: 600;
    cursor: pointer;
    border: none;
  }

  .btn-primary {
    background: var(--primary);
    color: #fff;
  }

  .btn-primary:hover {
    background: var(--primary-dark);
  }

  .btn-outline {
    background: #fff;
    border: 1px solid var(--border);
    color: var(--text);
  }

  .btn-outline:hover {
    background: #f1f5f9;
  }

  .footer-note {
    margin-top: 20px;
    font-size: 12px;
    color: var(--sub);
    line-height: 1.5;
  }
  
  hr { margin: 20px 0; border: 0; border-top: 1px solid #eee; }
</style>
</head>
<body>

<div class="page-wrap">
  <div class="card">

    <div class="title">
      <h2>ğŸš„ SRT ìë™ ì˜ˆë§¤</h2>
      <span>ë´‡ ì„¤ì •</span>
    </div>
    
    <div class="form-row">
      <label for="notifyUserId">ë¬¸ìë°›ì„ ID</label>
      <input type="text" id="notifyUserId" readonly placeholder="ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤">
    </div>

    <div class="form-row">
      <label for="srtId">SRT íšŒì›ë²ˆí˜¸ *</label>
      <input type="text" id="srtId" placeholder="ìˆ«ì 10ìë¦¬ (ì˜ˆ: 1234567890)" required>
    </div>

    <div class="form-row">
      <label for="srtPw">SRT ë¹„ë°€ë²ˆí˜¸ *</label>
      <input type="password" id="srtPw" placeholder="SRT ë¹„ë°€ë²ˆí˜¸" required>
    </div>
    
    <hr>

    <div class="form-row">
      <label for="dpt">ì¶œë°œì—­ *</label>
      <select id="dpt" required>
        <option value="ìˆ˜ì„œ" selected>ìˆ˜ì„œ</option>
        <option value="ë™íƒ„">ë™íƒ„</option>
        <option value="í‰íƒì§€ì œ">í‰íƒì§€ì œ</option>
        <option value="ì²œì•ˆì•„ì‚°">ì²œì•ˆì•„ì‚°</option>
        <option value="ì˜¤ì†¡">ì˜¤ì†¡</option>
        <option value="ëŒ€ì „">ëŒ€ì „</option>
        <option value="ê¹€ì²œêµ¬ë¯¸">ê¹€ì²œêµ¬ë¯¸</option>
        <option value="ë™ëŒ€êµ¬">ë™ëŒ€êµ¬</option>
        <option value="ê²½ì£¼">ê²½ì£¼</option>
        <option value="ìš¸ì‚°">ìš¸ì‚°</option>
        <option value="ë¶€ì‚°">ë¶€ì‚°</option>
      </select>
    </div>

    <div class="form-row">
      <label for="arv">ë„ì°©ì—­ *</label>
      <select id="arv" required>
        <option value="ë¶€ì‚°" selected>ë¶€ì‚°</option>
        <option value="ìˆ˜ì„œ">ìˆ˜ì„œ</option>
        <option value="ë™íƒ„">ë™íƒ„</option>
        <option value="í‰íƒì§€ì œ">í‰íƒì§€ì œ</option>
        <option value="ì²œì•ˆì•„ì‚°">ì²œì•ˆì•„ì‚°</option>
        <option value="ì˜¤ì†¡">ì˜¤ì†¡</option>
        <option value="ëŒ€ì „">ëŒ€ì „</option>
        <option value="ê¹€ì²œêµ¬ë¯¸">ê¹€ì²œêµ¬ë¯¸</option>
        <option value="ë™ëŒ€êµ¬">ë™ëŒ€êµ¬</option>
        <option value="ê²½ì£¼">ê²½ì£¼</option>
        <option value="ìš¸ì‚°">ìš¸ì‚°</option>
      </select>
    </div>

    <div class="form-row">
      <label for="date">ë‚ ì§œ *</label>
      <input id="date" type="date" required>
    </div>

    <div class="form-row">
      <label for="start">ì‹œê°„ *</label>
      <select id="start" required>
        <option value="05:00">05ì‹œ ì´í›„</option>
        <option value="06:00">06ì‹œ ì´í›„</option>
        <option value="07:00">07ì‹œ ì´í›„</option>
        <option value="08:00">08ì‹œ ì´í›„</option>
        <option value="09:00">09ì‹œ ì´í›„</option>
        <option value="10:00">10ì‹œ ì´í›„</option>
        <option value="11:00">11ì‹œ ì´í›„</option>
        <option value="12:00">12ì‹œ ì´í›„</option>
        <option value="13:00">13ì‹œ ì´í›„</option>
        <option value="14:00">14ì‹œ ì´í›„</option>
        <option value="15:00">15ì‹œ ì´í›„</option>
        <option value="16:00">16ì‹œ ì´í›„</option>
        <option value="17:00">17ì‹œ ì´í›„</option>
        <option value="18:00">18ì‹œ ì´í›„</option>
        <option value="19:00">19ì‹œ ì´í›„</option>
        <option value="20:00">20ì‹œ ì´í›„</option>
        <option value="21:00">21ì‹œ ì´í›„</option>
      </select>
    </div>

    <div class="btn-group">
      <button id="autoBtn" class="btn btn-primary">ğŸš€ ìë™ì˜ˆë§¤ ì‹œì‘</button>
      <button class="btn btn-outline" onclick="location.href='/'">ë©”ì¸ìœ¼ë¡œ</button>
    </div>

    <div class="footer-note">
      * ë´‡ ì„œë²„ê°€ êº¼ì ¸ìˆì–´ë„ ìë™ìœ¼ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤.<br>
      * ì˜ˆë§¤ ì„±ê³µ ì‹œ ìœ„ ì•„ì´ë””(íœ´ëŒ€í° ë²ˆí˜¸)ë¡œ ë¬¸ìê°€ ì „ì†¡ë©ë‹ˆë‹¤.
    </div>

  </div>
</div>

<script>
// [í•µì‹¬] ë¡œê·¸ì¸ ì •ë³´ ìë™ ì—°ë™
window.onload = function() {
    // 1. ë‚ ì§œ ê¸°ë³¸ê°’ ì„¤ì •
    document.getElementById('date').valueAsDate = new Date();

    // 2. ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ì—ì„œ ì•„ì´ë”” ê°€ì ¸ì˜¤ê¸°
    const savedId = sessionStorage.getItem("loginId");
    const notifyInput = document.getElementById("notifyUserId");

    if (savedId) {
        notifyInput.value = savedId; // ê°’ ì±„ì›Œë„£ê¸°
        console.log("âœ… ë¡œê·¸ì¸ëœ ì‚¬ìš©ì:", savedId);
    } else {
        alert("ë¡œê·¸ì¸ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤. ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.");
        location.href = "/boardEx/login"; // ë¡œê·¸ì¸ í˜ì´ì§€ ê²½ë¡œ í™•ì¸ í•„ìš”
    }
};

document.getElementById("autoBtn").addEventListener("click", () => {
  // 1. ê°’ ê°€ì ¸ì˜¤ê¸°
  const notifyUserId = document.getElementById("notifyUserId").value; // ìë™ ì…ë ¥ëœ ê°’
  const srtId = document.getElementById("srtId").value.trim();
  const srtPw = document.getElementById("srtPw").value.trim();
  const dpt = document.getElementById("dpt").value;
  const arv = document.getElementById("arv").value;
  const date = document.getElementById("date").value;
  const time = document.getElementById("start").value;

  // 2. ìœ íš¨ì„± ê²€ì‚¬
  if (!notifyUserId) {
      alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.");
      return;
  }
  if (!srtId || !srtPw) {
      alert("SRT íšŒì›ë²ˆí˜¸ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
      return;
  }
  if (dpt === arv) {
      alert("ì¶œë°œì—­ê³¼ ë„ì°©ì—­ì´ ê°™ìŠµë‹ˆë‹¤.");
      return;
  }

  // 3. ë°ì´í„° í¬ì¥
  const data = {
      loginId: notifyUserId, // ë¬¸ì ë°›ì„ ë‚´ ID
      srtId: srtId,          // ë´‡ì´ ì“¸ SRT ID
      loginPw: srtPw,        // ë´‡ì´ ì“¸ SRT PW
      dpt: dpt,
      arv: arv,
      date: date,
      time: time
  };

  console.log("ì „ì†¡ ë°ì´í„°:", data);
  alert("ë´‡ì„ ì‹¤í–‰í•©ë‹ˆë‹¤. ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”...");

  // 4. Spring Boot ì„œë²„ë¡œ ì „ì†¡
  fetch("/boardEx/autoScripts/srt/run", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data)
  })
  .then(response => response.json())
  .then(result => {
      if (result.result === "OK") {
          alert("ë´‡ ì‹¤í–‰ ì„±ê³µ!\n\nì„œë²„ ì»´í“¨í„°ì—ì„œ í¬ë¡¬ì°½ì´ ì—´ë ¸ìŠµë‹ˆë‹¤.\nì˜ˆë§¤ê°€ ì™„ë£Œë˜ë©´ ë¬¸ìë¡œ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤.");
      } else {
          alert("ì‹¤í–‰ ì‹¤íŒ¨: " + result.msg);
      }
  })
  .catch(err => {
      alert("ì„œë²„ ì—°ê²° ì—ëŸ¬: " + err);
  });
});
</script>

</body>
</html>